(window.webpackJsonp=window.webpackJsonp||[]).push([[212],{671:function(v,_,e){"use strict";e.r(_);var o=e(1),c=Object(o.a)({},(function(){var v=this,_=v._self._c;return _("ContentSlotsDistributor",{attrs:{"slot-key":v.$parent.slotKey}},[_("h3",{attrs:{id:"执行顺序"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#执行顺序"}},[v._v("#")]),v._v(" 执行顺序")]),v._v(" "),_("ul",[_("li",[v._v("第一步： 浏览器输入域名")])]),v._v(" "),_("p",[v._v("例如输入： www.csdn.net/")]),v._v(" "),_("ul",[_("li",[v._v("第二步：浏览器查找域名的"),_("code",[v._v("IP")]),v._v("地址")])]),v._v(" "),_("p",[v._v("浏览器会把输入的域名解析为对应的"),_("code",[v._v("IP")]),v._v("，其解析过程如下：")]),v._v(" "),_("p",[v._v("1、查找浏览器缓存：因为浏览器一般会缓存"),_("code",[v._v("DNS")]),v._v("记录一段时间，不同浏览器的时间可能不同，一般2~30分钟不等，浏览器去查找这些缓存，如果有缓存，直接返回IP，否则下一步；")]),v._v(" "),_("p",[v._v("2、查找系统缓存：浏览器缓存中找不到IP后，浏览器会进行系统调用（"),_("code",[v._v("Windows")]),v._v("中时"),_("code",[v._v("gethostbyname")]),v._v("），查找本机的host文件，如果找到，直接返回IP，否则下一步；")]),v._v(" "),_("p",[v._v("3、查找路由器缓存：如果1、2步都查询无果，则需要借助网络，路由器一般都有自己的"),_("code",[v._v("DNS")]),v._v("缓存，将前面的请求发给路由器，查找"),_("code",[v._v("ISP")]),v._v(" 服务商缓存"),_("code",[v._v("DNS")]),v._v("的服务器，如果查找到"),_("code",[v._v("IP")]),v._v("则直接返回，没有的话继续查找。")]),v._v(" "),_("p",[v._v("4、递归查询：如果以上步骤还找不到，则"),_("code",[v._v("ISP")]),v._v("的"),_("code",[v._v("DNS")]),v._v("服务器就会进行递归查询，所谓递归查询就是如果主机所询问的本地域名服务器不知道被查询域名的"),_("code",[v._v("IP")]),v._v("地址，那么本地域名服务器就以"),_("code",[v._v("DNS")]),v._v("客户的身份，向其他根域名服务器继续发出查询请求报文，而不是让该主机自己进行下一步查询。（本地域名服务器地址是通过DHCP协议获取地址，"),_("code",[v._v("DHCP")]),v._v("是负责分配IP地址的）")]),v._v(" "),_("p",[v._v("5、迭代查询：本地域名服务器采用迭代查询，它先向一个根域名服务器查询。本地域名服务器向根域名服务器的查询一般都是采用迭代查询。所谓迭代查询就是当根域名服务器收到本地域名服务器发出的查询请求报文后，要么告诉本地域名服务器下一步应该查询哪一个域名服务器，然后本地域名服务器自己进行后续的查询。（而不是替代本地域名服务器进行后续查询）。")]),v._v(" "),_("p",[v._v("本例子中：根域名服务器告诉本地域名服务器，下一次应查询的顶级域名服务器"),_("code",[v._v("dns.net")]),v._v("的"),_("code",[v._v("IP")]),v._v("地址。本地域名服务器向顶级域名服务器"),_("code",[v._v("dns.net")]),v._v("进行查询。顶级域名服务器"),_("code",[v._v("dns.net")]),v._v("告诉本地域名服务器，下一次应查询的权限域名服务器"),_("code",[v._v("dns.csdn.net")]),v._v("的"),_("code",[v._v("IP")]),v._v("地址。本地域名服务器向权限域名服务器"),_("code",[v._v("dns.csdn.net")]),v._v("进行查询。权限域名服务器dns.csdn.net告诉本地域名服务器，所查询的主机"),_("code",[v._v("www.csdn.net")]),v._v("的"),_("code",[v._v("IP")]),v._v("地址。本地域名服务器最后把结果告诉主机。")]),v._v(" "),_("ul",[_("li",[v._v("第三步:浏览器与目标服务器建立"),_("code",[v._v("TCP")]),v._v("连接")])]),v._v(" "),_("p",[v._v("1、主机浏览器通过DNS解析得到了目标服务器的IP地址后，与服务器建立TCP连接。")]),v._v(" "),_("p",[v._v("2、TCP3次握手连接：浏览器所在的客户机向服务器发出连接请求报文（SYN标志为1）；服务器接收报文后，同意建立连接，向客户机发出确认报文（SYN，ACK标志位均为1）；客户机接收到确认报文后，再次向服务器发出报文，确认已接收到确认报文；此处客户机与服务器之间的TCP连接建立完成，开始通信。")]),v._v(" "),_("ul",[_("li",[v._v("第四步: 浏览器通过HTTP协议发送请求")])]),v._v(" "),_("p",[v._v("浏览器向主机发起一个"),_("code",[v._v("HTTP-GET")]),v._v("方法报文请求。请求中包含访问的"),_("code",[v._v("URL")]),v._v("，也就是http://www.csdn.com/ ，KeepAlive，长连接，还有User-Agent用户浏览器操作系统信息，编码等。值得一提的是Accep-Encoding和Cookies项。Accept-Encoding一般采用gzip，压缩之后传输html文件。Cookies如果是首次访问，会提示服务器建立用户缓存信息，如果不是，可以利用Cookies对应键值，找到相应缓存，缓存里面存放着用户名，密码和一些用户设置项。")]),v._v(" "),_("ul",[_("li",[v._v("第五步:某些服务会做永久重定向响应")])]),v._v(" "),_("p",[v._v("对于大型网站存在多个主机站点，为了负载均衡或者导入流量，提高"),_("code",[v._v("SEO")]),v._v("排名，往往不会直接返回请求页面，而是重定向。返回的状态码就不是200OK，而是301,302以3开头的重定向码，浏览器在获取了重定向响应后，在响应报文中"),_("code",[v._v("Location")]),v._v("项找到重定向地址，浏览器重新第一步访问即可。")]),v._v(" "),_("p",[v._v("重定向的作用：重定向是为了负载均衡或者导入流量，提高SEO排名。利用一个前端服务器接受请求，然后负载到不同的主机上，可以大大提高站点的业务并发处理能力；重定向也可将多个域名的访问，集中到一个站点；由于baidu.com，www.baidu.com会被搜索引擎认为是两个网站，照成每个的链接数都会减少从而降低排名，永久重定向会将两个地址关联起来，搜索引擎会认为是同一个网站，从而提高排名。")]),v._v(" "),_("ul",[_("li",[v._v("第六步: 浏览器跟踪重定向地址")])]),v._v(" "),_("p",[v._v("当浏览器知道了重定向后最终的访问地址之后，重新发送一个HTTP请求，发送内容同上。")]),v._v(" "),_("ul",[_("li",[v._v("第七步：服务器处理请求")])]),v._v(" "),_("p",[v._v("服务器接收到获取请求，然后处理并返回一个响应。")]),v._v(" "),_("ul",[_("li",[v._v("第八步： 服务器发处一个HTML响应")])]),v._v(" "),_("p",[v._v("返回状态码"),_("code",[v._v("200 OK")]),v._v("，表示服务器可以响应请求，返回报文，由于在报头中"),_("code",[v._v("Content-type")]),v._v("为“text/html”，浏览器以"),_("code",[v._v("html")]),v._v("的形式呈现，而不是下载文件；")]),v._v(" "),_("ul",[_("li",[v._v("第九步：释放TCP连接")])]),v._v(" "),_("p",[v._v("1、浏览器所在主机向服务器发出连接释放报文，然后停止发送数据；")]),v._v(" "),_("p",[v._v("2、服务器接收到释放报文后发出确认报文，然后将服务器上未传送完的数据发送完；")]),v._v(" "),_("p",[v._v("3、服务器数据传输完毕后，向客户机发送连接释放报文；")]),v._v(" "),_("p",[v._v("4、客户机接收到报文后，发出确认，然后等待一段时间后，释放TCP连接；")]),v._v(" "),_("ul",[_("li",[v._v("第十步：浏览器显示页面")])]),v._v(" "),_("p",[v._v("在浏览器没有完整接受全部"),_("code",[v._v("HTML")]),v._v("文档时，它就已经开始显示这个页面了，浏览器接收到返回的数据包，根据浏览器的渲染机制对相应的数据进行渲染。渲染后的数据，进行相应的页面呈现和脚步的交互。")]),v._v(" "),_("ul",[_("li",[v._v("第十一步：浏览器发送获取嵌入在"),_("code",[v._v("HTML")]),v._v("中的其他内容")])]),v._v(" "),_("p",[v._v("比如一些样式文件"),_("code",[v._v("url")]),v._v("，"),_("code",[v._v("js")]),v._v("文件"),_("code",[v._v("url")]),v._v("等，浏览器会通过这些url重新发送请求，请求过程依然是HTML读取类似的过程，查询域名，发送请求，重定向等。不过这些静态文件是可以缓存到浏览器中的，有时访问这些文件不需要通过服务器，直接从缓存中取。某些网站也会使用第三方CDN进行托管这些静态文件。")])])}),[],!1,null,null,null);_.default=c.exports}}]);